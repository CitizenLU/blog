# 1 概述

Java虚拟机把描述类的数据从Class文件加载到内存，并对数据进行校验、转换解析和初始化，最终形成可以被虚拟机直接使用的Java类型，这个过程被称作虚拟机的类加载机制。

约定： 
1、“类型”表示类和接口
2、“Class文件”不特指某个磁盘中的文件，而是一串二进制字节流。包括但不限于磁盘文件、网络、数据库、内存或者动态产生等。

# 2 类加载时机

![类加载时机.png](https://images-lu.oss-cn-shanghai.aliyuncs.com/4%29D05V%5DAT0870_78H7Z%5BF0N.png)



有且仅有6种情况必须对类进行“初始化”（而加载、验证、准备自然需要在此之前进行）
1、遇到new、getstatic、putstatic或invokestatic这4个字节码指令时，如果类型没有进行过初始化，则需要先触发其初始化阶段。能够生成这4条指令的典型Java代码场景有：
1）使用new关键字实例化对象的时候。
2）读取（getstatic）或设置（putstatic）一个类型的静态字段（被final修饰、已在编译期把结果放入常量池的静态字段除外）的时候。
3）调用一个类型的静态方法的时候（invokestatic）。
2、使用java.lang.reflect包的方法对类型进行反射调用的时候，如果类型没有进行过初始化，则需要先触发其初始化。
3、当初始化类的时候，如果发现其父类还没有进行过初始化，则需要先触发其父类的初始化。
4、当虚拟机启动时，用户需要指定一个要执行的主类（包含main()方法的那个类），虚拟机会先初始化这个主类。
5、当使用jdk新加入的动态语言支持
6、当一个接口中定义了jdk8新加入的default方法时，如果这个接口的实现类发生了初始化，那么该接口要在其之前被初始化。